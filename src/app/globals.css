@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --section-y-sm: 48px;
  --section-y-lg: 72px;
  --page-bottom-safe: 96px; /* タブ+余白を96pxに統一 */
  --header-mobile: 64px;
  --safe-bottom: 96px;
  
  /* brand blues (福島寄せ) */
  --blue-900: #103a6f;
  --blue-800: #184d92;
  --blue-700: #2563b8;
  --blue-600: #2d6cdf;
  --blue-500: #3b82f6;
  --blue-100: #e9f3ff;

  /* emerald (投稿側) */
  --em-700: #0f8f6f;
  --em-600: #10a37f;
  --em-100: #e7fff2;

  /* text / surfaces */
  --ink-900: #0f172a;
  --ink-700: #1f2937;
  --ink-500: #475569;
  --card: #ffffff;
  --muted: #f5f7fb;
  --ring: #cfe1ff;

  /* shadows */
  --elev-1: 0 1px 3px rgba(16,24,40,.08),0 1px 2px rgba(16,24,40,.06);
  --elev-2: 0 8px 24px rgba(16,24,40,.12);

  /* type scale（ベース+太さ） */
  --h1: clamp(28px,3.2vw,40px);
  --h2: clamp(22px,2.4vw,28px);
  --lead: clamp(16px,1.6vw,18px);
  
  /* 旧トークン（後方互換性） */
  --tab-find-bg: var(--blue-100);
  --tab-find-ac: var(--blue-700);
  --tab-post-bg: var(--em-100);
  --tab-post-ac: var(--em-700);
  --chip-interest: #6B7280;
  --chip-consider: #0EA5E9;
  --chip-buy: #10B981;
  
  /* 福島式タブ用トークン */
  --ndp-find-bg: #E9F3FF;
  --ndp-find-border: #B7D7FF;
  --ndp-find-accent: #4C7DBF;

  --ndp-post-bg: #E7FFF2;
  --ndp-post-border: #A9F0CB;
  --ndp-post-accent: #1B9C75;
  
  /* 福島式付箋タブ用トークン */
  --panel-blue-bg: #E9F3FF;      /* パネル＆選択タブ */
  --panel-blue-accent: #2F63B7;  /* 未選択タブ＆主要ボタン */
  --panel-blue-text: #1F2A44;    /* 濃紺テキスト */
  --audience-surface: #F3F6FA;   /* おすすめ面の地色（薄グレー） */
  
  /* 福島式UI統一トークン */
  --np-blue: #2F63B7;        /* 濃青（強調/未選択タブ/強線） */
  --np-blue-bg: #E9F3FF;     /* 薄青（付箋パネル） */
  --np-ink: #1F2A44;         /* 濃紺テキスト */
  --np-border: #C9DCF7;      /* 淡い境界線 */
  --np-surface: #F5F7FB;     /* 薄グレー面（カード群の外側帯） */
  
  --aside-w: 280px;          /* PC左ドック幅 */
}

/* セクション余白のユーティリティ（必要箇所で使用） */
.section { 
  padding-block: var(--section-y-sm); 
}

.section-lg { 
  padding-block: var(--section-y-lg); 
}

main { 
  padding-bottom: var(--page-bottom-safe); 
}

/* スマホ時の上余白 */
.pt-header { 
  padding-top: var(--header-mobile); 
}

/* ページ最下部の安全領域 */
.pb-safe-bottom {
  padding-bottom: var(--safe-bottom);
}

/* フォーム用ユーティリティ */
.input{ @apply w-full rounded border border-gray-300 bg-white px-3 py-2 text-sm; }

/* 安全な下余白ユーティリティ */
.pb-safe {
  padding-bottom: max(6rem, 12vh);
}

/* セクション余白ユーティリティ */
.section-y-sm {
  padding-top: 48px;
  padding-bottom: 48px;
}

.section-y-lg {
  padding-top: 72px;
  padding-bottom: 72px;
}

@media (min-width: 1024px) {
  .section-y-sm {
    padding-top: 64px;
    padding-bottom: 64px;
  }
  
  .section-y-lg {
    padding-top: 80px;
    padding-bottom: 80px;
  }
}

/* "波"区切り（軽量） */
.wave-divider {
  height: 1px;
  background: linear-gradient(to right, transparent, rgb(186 230 253 / 0.5), transparent);
}

/* 信頼バッジ用CSSドット */
.trust-dot {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-right: 6px;
}

.trust-dot.high {
  background-color: #10b981; /* green-500 */
}

.trust-dot.mid {
  background-color: #f59e0b; /* amber-500 */
}

.trust-dot.low {
  background-color: #ef4444; /* red-500 */
}

/* 既存のスタイル */

/* iOS Safari でもフォームを常にライトにする */
:root { color-scheme: light; } /* iOSの自動ダーク抑止 */
html { text-size-adjust: 100%; }
html,body { height: 100%; }
body { @apply bg-white text-neutral-900 antialiased; }

/* BottomNav に隠れないように常時下余白を確保 */
main { padding-bottom: calc(env(safe-area-inset-bottom) + 72px); }
 
 @layer components {
   /* PCの横幅を広げる（視認性UP） */
  .container { @apply mx-auto max-w-7xl px-3 sm:px-6; }
  .container-wide { @apply mx-auto max-w-[1400px] px-4 sm:px-6; }
  .text-balance { text-wrap: balance; }
   /* Yellow section (もうすぐ成立) アクセント */
   .section--emphasis { @apply container py-12 bg-gradient-to-b from-amber-50 to-orange-50 border-y border-orange-100; }
   /* タイトル/本文の安全な折返し & 行数制限 */
   .np-title { @apply font-semibold text-neutral-900 break-words; }
   .np-text  { @apply text-neutral-700 break-words; }
   /* line-clamp (plugin無し) */
   .line-clamp-1{ display:-webkit-box; -webkit-box-orient:vertical; -webkit-line-clamp:1; overflow:hidden; }
   .line-clamp-2{ display:-webkit-box; -webkit-box-orient:vertical; -webkit-line-clamp:2; overflow:hidden; }
   .line-clamp-3{ display:-webkit-box; -webkit-box-orient:vertical; -webkit-line-clamp:3; overflow:hidden; }
   /* フォーム統一 */
   .np-input { @apply bg-white text-neutral-900 placeholder:text-neutral-400 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-600 focus:border-brand-600; }
   .np-textarea { @apply np-input min-h-[120px]; }
   /* テキストバランス */
   .text-balance { text-wrap: balance; }
   .content-wrap { word-break: break-word; overflow-wrap: anywhere; }
   /* 入力を常に白に（iOSの自動ダーク無効化） */
   .np-input { @apply bg-white text-neutral-900 placeholder:text-neutral-400 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-600 focus:border-brand-600; }
   .np-textarea { @apply np-input min-h-[120px]; }
   .text-balance { text-wrap: balance; }
     /* 港トーンの面 */
  .hero-harbor { @apply bg-gradient-to-b from-foam-50 to-white ring-1 ring-black/5; }
  .hero-harbor::after{
    content:""; position:absolute; inset:0; pointer-events:none;
    background:radial-gradient(60% 60% at 20% 20%, rgba(14,165,233,.10), transparent 60%),
               radial-gradient(60% 60% at 80% 30%, rgba(79,70,229,.08), transparent 60%);
  }
  .hero-sky    { @apply bg-gradient-to-br from-sky-100 via-indigo-50 to-white ring-1 ring-black/5; }
  .surface-soft { @apply rounded-2xl bg-white/95 shadow-card border border-black/5; }
      .kicker { @apply inline-flex items-center gap-2 text-sm font-medium text-blue-700; }
   
   /* うっすら波パターン（パフォーマンス軽いCSS） */
   .sea-waves {
     --c1: rgba(20,184,166,.08); --c2: rgba(37,99,235,.06);
     background:
       radial-gradient(60% 100% at 50% 120%, var(--c1), transparent 60%),
       radial-gradient(70% 120% at 50% 120%, var(--c2), transparent 60%),
       linear-gradient(to bottom, #fff, #fff);
   }
     /* セクション区切りの"さざ波" */
  .wave-divider {
    height:20px; background:linear-gradient(to right, rgba(14,165,233,.15), rgba(79,70,229,.15));
    -webkit-mask:radial-gradient(8px at 8px 10px,#000 98%,transparent 102%) repeat-x; 
    mask:radial-gradient(8px at 8px 10px,#000 98%,transparent 102%) repeat-x;
  }
   .np-buoy { @apply inline-flex items-center gap-2 px-2.5 py-1 rounded-full text-[12px] font-medium bg-buoy-500/10 text-buoy-500; }
   
   /* --- Nautical visuals ------------------------------------ */
   /* 空→海の淡グラデ + 薄い枠 */
   .hero-ocean { @apply bg-gradient-to-b from-sky-100 via-cyan-50 to-white ring-1 ring-black/5 rounded-2xl; }

   /* セクション下端の白波。SVGを使うので土台だけ用意 */
   .wave-holder { @apply relative overflow-hidden rounded-2xl; }
   .wave-svg { position:absolute; left:0; right:0; bottom:-1px; width:100%; height:48px; }

   /* ステップカード（白面＋淡影＋大きめ字間） */
   .step-card { @apply surface-soft p-5 sm:p-6 text-neutral-700; }
   .step-kicker { @apply text-sm font-medium text-blue-700 inline-flex items-center gap-2; }

   /* モチーフは全部飾り。読み上げ防止 */
   .decoration { pointer-events:none; }
   .card { @apply rounded-2xl border border-white/10 bg-white/5 backdrop-blur p-4 shadow-lg; }
   
   /* Boat micro-interaction -------------------------------------------------- */
   @keyframes np-boat-sail {
     0%   { transform: translateX(0) translateY(0) rotate(0deg); }
     20%  { transform: translateX(20vw) translateY(-2px) rotate(-1deg); }
     40%  { transform: translateX(40vw) translateY(1px)  rotate(1deg); }
     60%  { transform: translateX(65vw) translateY(-1px) rotate(-.5deg); }
     80%  { transform: translateX(90vw) translateY(1px)  rotate(.5deg); }
     100% { transform: translateX(120vw) translateY(0) rotate(0deg); }
   }
   @keyframes np-boat-wake {
     0%   { stroke-opacity:.9; filter: blur(0px); }
     60%  { stroke-opacity:.5; filter: blur(1px); }
     100% { stroke-opacity:0;  filter: blur(2px); }
   }
   .np-boat { animation: np-boat-sail var(--dur,2.8s) ease-in-out forwards; }
   .np-wake { animation: np-boat-wake var(--dur,2.8s) ease-out forwards; }
   
   /* 低モーション配慮 */
   @media (prefers-reduced-motion: reduce) {
     .np-boat, .np-wake { animation: none !important; display: none; }
   }
   
     /* 軽い港味のマイクロ演出 */
  @keyframes np-bob { 0%,100%{ transform: translateY(0) } 50%{ transform: translateY(-2px) } }
  .bob { animation: np-bob 3s ease-in-out infinite; transform-origin: 50% 100%; }
  
  /* 福島式パネルの基礎 */
  .ndp-panel{
    border:1px solid var(--ndp-border);
    background: var(--ndp-bg);
    border-radius: 16px;
  }

  /* モード別に変数を注入 */
  .ndp-panel[data-mode="find"]{
    --ndp-bg: var(--ndp-find-bg);
    --ndp-border: var(--ndp-find-border);
    --ndp-accent: var(--ndp-find-accent);
  }
  .ndp-panel[data-mode="post"]{
    --ndp-bg: var(--ndp-post-bg);
    --ndp-border: var(--ndp-post-border);
    --ndp-accent: var(--ndp-post-accent);
  }

  /* タブ（セグメント） */
  .ndp-tabbar{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:.5rem;
    border-radius: 12px;
    /* タブバー自体はパネルと一体化させる（背景透過） */
    background: transparent;
  }

  .ndp-tab{
    height: 44px;
    border-radius: 10px;
    background: transparent;
    color: color-mix(in srgb, var(--ndp-accent) 90%, #000 0%);
    font-weight: 600;
    border: 1px solid transparent;
    transition: background .2s ease, color .2s ease, border-color .2s ease;
  }
  .ndp-tab[aria-selected="true"]{
    background: #fff;               /* 押した側は白っぽく */
    border-color: color-mix(in srgb, var(--ndp-accent) 25%, #fff 75%);
  }
  .ndp-tab[aria-selected="false"]:hover{ 
    background: rgba(255,255,255,.45);
  }
  
  /* タブを面と"つなぐ"ための専用クラス（付箋風） */
  .tab-attach {
    position: relative;
  }
  .tab-attach[aria-selected="true"]::after {
    content: "";
    position: absolute;
    left: -1px; right: -1px; bottom: -1px;
    height: 2px;
    background: var(--panel-blue-bg);  /* 面と同色で下線を塗り潰し、一体化 */
    border-bottom-left-radius: .75rem;
    border-bottom-right-radius: .75rem;
  }
  
  /* 面を左ドック端まで広げる（PCのみ） */
  .np-full-bleed-to-aside{ /* 左ドック端まで伸ばす（PCのみ） */
    margin-left: calc(var(--np-aside-offset, -24px));
    padding-left: calc(var(--np-aside-pad, 24px));
  }
  @media (max-width: 1023px){
    .np-full-bleed-to-aside{ margin-left: 0; padding-left: 0; }
  }
  
  /* タイポの底上げ */
  .np-heading{ font-weight: 700; color: var(--np-ink); }
  .np-sub{ font-weight: 600; color: var(--np-ink); }
  .np-body{ font-weight: 500; color: var(--np-ink); }
  
  /* 市町村チップの読みやすさ */
  .np-chip{ 
    padding: 6px 12px; 
    border-radius: 999px; 
    border: 1px solid var(--np-border);
    line-height: 1.2;
    font-weight: 600;
    color: var(--np-ink);
    background: #fff;
  }
  .np-chip:focus{ outline: 2px solid var(--np-blue); outline-offset: 2px; }
   
   /* ボタンのさざ波クリック */
   .btn-wave { position: relative; overflow: hidden; }
   .btn-wave:after {
     content:""; position:absolute; inset:auto; left:50%; top:50%;
     width:0; height:0; background:rgba(59,130,246,.25); border-radius:9999px;
     transform:translate(-50%,-50%); pointer-events:none;
   }
   .btn-wave:active:after { width:220%; height:220%; transition: width .35s ease, height .35s ease, opacity .6s ease; opacity:0; }
   
   /* カードの"持ち上がり"＋"軽い押し込み" */
   .card-hover { transition: transform .15s ease, box-shadow .15s ease; }
   .card-hover:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,.06) }
   .card-press:active { transform: translateY(0) scale(.98) }
   
   /* "タップできるヒント"のパルス */
   .pulse-dot::after{
     content:""; display:inline-block; width:6px; height:6px; margin-left:.35rem;
     border-radius:9999px; background:#3b82f6; box-shadow:0 0 0 0 rgba(59,130,246,.6);
     animation: pulse 1.8s cubic-bezier(.66,0,0,1) infinite;
   }
   @keyframes pulse{100%{box-shadow:0 0 0 10px rgba(59,130,246,0)}}
  .btn { @apply inline-flex items-center justify-center gap-2 rounded-lg h-11 px-4 text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus:ring-2 focus:ring-offset-2 focus:ring-brand-500; }
  .btn-primary { @apply btn bg-brand-600 text-white hover:bg-brand-500 focus:ring-brand-500; }
  .btn-ghost { @apply btn bg-white/5 hover:bg-white/10 focus:ring-white/20; }
  .chip { @apply inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-white/10 border border-white/20; }
  .progress { @apply w-full h-2 bg-white/10 rounded-full overflow-hidden; }
  .progress-bar { @apply h-full bg-gradient-to-r from-emerald-500 to-blue-500 rounded-full transition-all duration-300; }
  
  /* Readdy UI Tokens */
  .section { @apply container py-10 sm:py-12 bg-white; }
  .np-card { @apply rounded-xl shadow-card border border-black/5 bg-white/90 dark:bg-white/5; }
  .np-badge { @apply rounded-full px-2.5 py-0.5 text-xs font-medium; }
  .np-progress { @apply h-2 rounded-full overflow-hidden; }

  /* 画面遷移のスケルトンを黒→淡グレーに統一 */
  .skeleton       { @apply bg-neutral-200 animate-pulse rounded; }
  .skeleton-line  { @apply h-3 skeleton; }
  .skeleton-btn   { @apply h-9 w-28 skeleton rounded-lg; }

  /* モバイルの自然改行を強化 */
  .text-balance { text-wrap: balance; }

  /* ==== Port Animations ==== */
  @keyframes np-sail { from { transform:translateX(-20vw) rotate(-.5deg) } to { transform:translateX(120vw) rotate(.8deg) } }
  @keyframes np-wake { from { transform:translateX(-20vw); opacity:0 } 10%{opacity:.28} to { transform:translateX(120vw); opacity:0 } }
  .np-ship { @apply fixed left-0 bottom-[82px] z-[70] pointer-events-none will-change-transform; animation: np-sail 1.8s ease-in-out both; }
  .np-wake { @apply fixed left-0 bottom-[78px] z-[69] h-[2px] w-[18vw] rounded-full
                   bg-gradient-to-r from-cyan-300/70 via-white/30 to-transparent blur-[2px] will-change-transform;
             animation: np-wake 1.8s ease-in-out both; }
  @media (prefers-reduced-motion: reduce) { .np-ship,.np-wake { animation:none!important; opacity:0 } }

  /* 横スクロールUIのスクロールバー非表示 */
  .no-scrollbar { scrollbar-width:none }
  .no-scrollbar::-webkit-scrollbar { display:none }

  /* FlowRail 船アニメーション */
  .ship-track { position: relative; height: 100%; }
  .ship-icon {
    width: 26px; height: 26px; color: #2563eb; /* blue-600 */
    position: absolute; top: 22px; left: -26px; filter: drop-shadow(0 2px 6px rgba(37,99,235,.25));
  }
  .ship-track.play .ship-icon {
    animation: sail 4.8s ease-in-out 0.2s forwards;
  }
  @keyframes sail {
    from { transform: translateX(0); }
    to   { transform: translateX(calc(100vw - 48px)); } /* SPは画面幅に合わせる */
  }
  @media (min-width: 768px){
    .ship-track.play .ship-icon { animation: sail-pc 5.2s ease-in-out 0.2s forwards; }
    @keyframes sail-pc {
      from { transform: translateX(16px); }
      to   { transform: translateX(calc(100% - 64px)); } /* カード内の端から端へ */
    }
  }
  /* 横スクロール用 */
  .scrollbar-none::-webkit-scrollbar { display: none; }

  /* FlowStrip 船アニメーション */
  @keyframes sail { from{transform:translateX(0)} to{transform:translateX(calc(100% - 1.75rem))} }
  @keyframes wave { from{transform:translateX(-28%)} to{transform:translateX(28%)} }

  .route-boat { animation: sail 14s ease-in-out infinite; }
  .route-water { background: linear-gradient(90deg, #bae6fd33, #38bdf833, #bae6fd33);
                 animation: wave 5s ease-in-out infinite alternate; }
  @media (prefers-reduced-motion: reduce) {
    .route-boat, .route-water { animation: none; }
  }
  
  /* ダイヤの残骸を確実に無効化 */
  .np-brand-diamond,
  .np-brand-diamond::before,
  .np-brand-diamond::after { content: none !important; background: none !important; }
  
  /* brand diamond hard-kill */
  header .np-brand-diamond,
  header .np-brand-diamond::before,
  header .np-brand-diamond::after { content: none !important; background: none !important; }
  
  h1 { @apply text-2xl sm:text-3xl font-semibold tracking-tight; }
  h2 { @apply text-xl sm:text-2xl font-semibold tracking-tight; }
  p  { @apply leading-7 text-neutral-300; }
  a { @apply text-brand-600 underline-offset-4 hover:underline; }
}
