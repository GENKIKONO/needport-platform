# Need Scale 機能 スモークテスト

## 前提条件
- データベースにサンプルデータが投入済み (`npm run seed:scale`)
- 開発サーバーが起動中 (`npm run dev`)

## テスト手順

### 1. API 投稿テスト (curl)
```bash
# Personal need
curl -X POST http://localhost:3000/api/needs \
  -H "Content-Type: application/json" \
  -d '{
    "title": "個人ブログのデザイン改善",
    "summary": "現在のブログが古く、スマホ対応もできていないため、新しいデザインで集客力を上げたい。",
    "scale": "personal",
    "agree": true
  }'

# Community need
curl -X POST http://localhost:3000/api/needs \
  -H "Content-Type: application/json" \
  -d '{
    "title": "地域イベントのWebサイト制作",
    "summary": "年2回開催する地域イベントのWebサイトを制作したい。",
    "scale": "community",
    "macro_fee_hint": "上限50万円",
    "macro_use_freq": "年2回のイベント",
    "macro_area_hint": "高知県内",
    "agree": true
  }'
```

### 2. 投稿フォーム (radio 切替 / macro_* 表示制御)
- [ ] `/needs/new` にアクセス
- [ ] 「わたしごと」を選択 → 補助フィールドが非表示
- [ ] 「みんなごと」を選択 → 補助フィールドが表示
- [ ] 補助フィールドに120文字制限が効く
- [ ] 必須マーク（*）が表示される
- [ ] 説明文「※ みんなごとを選ぶと会費目安などを設定できます」が表示

### 3. 一覧フィルタ (URL とSSR結果)
- [ ] `/` にアクセス → すべてのニーズが表示
- [ ] 「わたしごと」タブをクリック → URLに `?scale=personal` が追加
- [ ] 「みんなごと」タブをクリック → URLに `?scale=community` が追加
- [ ] 「すべて」タブをクリック → URLから `scale` パラメータが削除
- [ ] フィルタ切り替えで結果が正しく絞り込まれる

### 4. カード表示 (バッジ/CTA/概要)
- [ ] わたしごとのカードに「わたしごと」バッジが表示
- [ ] みんなごとのカードに「みんなごと」バッジが表示
- [ ] わたしごとのCTAが「購入したい」
- [ ] みんなごとのCTAが「顧客になりたい」
- [ ] みんなごとのカードに概要ブロックが表示（補助フィールドがある場合）
- [ ] わたしごとのカードに概要ブロックが非表示

### 5. 詳細表示
- [ ] わたしごとの詳細ページに「わたしごと」バッジが表示
- [ ] みんなごとの詳細ページに「みんなごと」バッジが表示
- [ ] みんなごとの詳細ページに概要セクションが表示（補助フィールドがある場合）
- [ ] わたしごとの詳細ページに概要セクションが非表示

### 6. CSV の列増加
- [ ] `/admin/needs.csv` にアクセス
- [ ] CSVに「種類」列が含まれる
- [ ] CSVに「会費目安」「利用頻度」「対象エリア」列が含まれる
- [ ] わたしごとの行で補助列が空欄
- [ ] みんなごとの行で補助列に値が入る

### 7. 管理画面での確認
- [ ] `/admin/needs/[id]/ops` で scale バッジが表示
- [ ] community の場合は macro_* フィールドが「メモ」として表示

### 8. 既存採用機能等との干渉なし
- [ ] 既存の採用機能が正常に動作
- [ ] 既存の検索・ソート機能が正常に動作
- [ ] 既存のページネーションが正常に動作
- [ ] 管理画面の既存機能が正常に動作

## エラー確認
- [ ] ブラウザのコンソールにエラーがない
- [ ] サーバーのログにエラーがない
- [ ] TypeScript コンパイルエラーがない (`npm run typecheck`)

## 完了条件
- 上記すべての項目が ✅ になること
- 新機能が既存機能を壊していないこと
- API 投稿が RLS エラーなく通ること
